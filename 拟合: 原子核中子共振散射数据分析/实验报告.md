# 原子核中子共振散射数据分析与拟合 - 实验报告

## 1. 实验目的

本实验旨在通过分析原子核中子的共振散射实验数据，掌握Breit-Wigner共振公式拟合的基本方法。具体目标包括：

- 理解Breit-Wigner共振公式的物理意义
- 掌握使用`scipy.optimize.curve_fit`进行数据拟合的方法
- 比较考虑误差和不考虑误差两种拟合方法的结果差异
- 学习科学数据的可视化表示方法

## 2. 方法简述

请简要描述你实现各个任务的方法和思路，特别是：

- Breit-Wigner共振公式的实现方式
```
通过定义函数breit_wigner实现该公式，将能量 E及参数 Er、Γ、fr作为输入，返回对应能量下的截面值。
```

- 两种拟合方法(考虑误差和不考虑误差)的具体实现细节
```
不考虑误差的拟合：
使用scipy.optimize.curve_fit函数，仅输入能量数据和截面数据，通过设置初始猜测值，最小化数据点与拟合曲线的残差平方和，获取最佳拟合参数及协方差矩阵。
考虑误差的拟合：
在curve_fit函数中额外传入数据的误差信息，通过sigma参数指定误差，并设置absolute_sigma=True，使拟合过程中考虑每个数据点的不确定性，通过加权最小二乘法优化拟合结果。
```

- 误差处理方法
```
考虑误差的拟合中，使用数据的测量误差作为权重，误差较小的数据点在拟合中贡献更大；通过协方差矩阵计算拟合参数的标准误差，并乘以 1.96 得到 95% 置信区间（CI），量化参数的不确定性。
```

- 可视化实现的关键步骤
```
1.使用matplotlib库的errorbar函数绘制带误差棒的数据点；
2.在数据范围内生成精细的能量网格，计算对应拟合曲线；
3.使用plot函数绘制拟合曲线；
4.在图中添加标题、轴标签、图例，并通过text函数标注拟合参数及其误差；
5.开启网格线并调整布局，使图表清晰美观。
```

## 3. 实验结果

### 3.1 不考虑误差的拟合结果

请在此处填写不考虑误差的拟合结果：
```
Er = [77.5] ± [1.4] MeV (95% CI)
Γ = [56.2] ± [3.5] MeV (95% CI)
fr = [66886] ± [6740] (95% CI)
```
### 3.2 考虑误差的拟合结果

请在此处填写考虑误差的拟合结果：
```
Er = [78.2] ± [25.1] MeV (95% CI)
Γ = [59.2] ± [65.9] MeV (95% CI)
fr = [70878] ± [67533] (95% CI)
```

### 3.4 拟合曲线图

请在此处插入你绘制的拟合曲线图(两种方法各一张)。图表应包含以下元素：

- 数据点(带误差棒)
- 最佳拟合曲线
- 图表标题："Breit-Wigner Fit (With/Without Errors)"
- X轴标签："Energy (MeV)"
- Y轴标签："Cross Section (mb)"
- 图例，包括数据点和拟合曲线的说明
- 拟合参数及其误差的标注

![Figure_1](https://github.com/user-attachments/assets/459652e4-1051-4765-b579-1e76aace96d6)

![Figure_2](https://github.com/user-attachments/assets/a84c5c99-4546-4a7f-ba35-bc3fdeb04a62)


### 3.5 核心代码片段

请在此处粘贴你实现的关键代码片段：

```python


```

## 4. 分析与讨论
### 4.1 拟合结果比较
请比较两种拟合方法得到的参数差异，分析误差处理对拟合结果的影响。

### 4.2 误差分析
请讨论实验中可能的误差来源，包括但不限于：

- 数据本身的测量误差
- 拟合算法的局限性
- 模型假设的合理性
### 4.3 思考题
1. 考虑误差的拟合方法在什么情况下特别重要？为什么？
* 答：当数据的测量误差较大、数据点数量较少或数据存在显著波动时，考虑误差的拟合尤为重要。此时，忽略误差可能导致拟合曲线过度拟合局部数据点，而考虑误差的加权最小二乘法可平衡各数据点的贡献，提供更符合实际不确定性的参数估计。

2. 如何评估拟合结果的可靠性？有哪些统计指标可以帮助判断拟合质量？
* 评估拟合结果的可靠性：置信区间：参数的置信区间越窄，表明估计值越精确。
* 其他可以帮助判断拟合质量的统计指标：卡方统计量及其约化值，残差分析。

## 5. 结论

通过本次实验，掌握了 Breit-Wigner 共振公式的拟合方法，理解了误差处理对拟合结果的重要性。实验表明，不考虑误差的拟合可能低估参数的不确定性，而考虑误差的拟合能更真实地反映数据的可靠性。同时，通过可视化和统计指标分析，学会了评估拟合质量，认识到模型假设、算法局限性和测量误差对结果的影响。这些知识和技能对处理复杂实验数据具有重要意义。

## 6. 参考文献
请列出你在实验过程中参考的文献、书籍或网站。(可选)
